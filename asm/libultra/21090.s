.include "macro.inc"

# assembler directives
.set noat      # allow manual use of $at
.set noreorder # don't insert nops after branches
.set gp=64     # allow use of 64-bit general purpose registers

.section .text, "ax"

glabel func_80020490
/* 21090 80020490 27BDFFD8 */  addiu      $sp, $sp, -0x28
/* 21094 80020494 AFB00010 */  sw         $s0, 0x10($sp)
/* 21098 80020498 3C108003 */  lui        $s0, %hi(D_80031134)
/* 2109C 8002049C 8E101134 */  lw         $s0, %lo(D_80031134)($s0)
/* 210A0 800204A0 3C02A440 */  lui        $v0, (0xA4400010 >> 16)
/* 210A4 800204A4 34420010 */  ori        $v0, $v0, (0xA4400010 & 0xFFFF)
/* 210A8 800204A8 AFBF0024 */  sw         $ra, 0x24($sp)
/* 210AC 800204AC AFB40020 */  sw         $s4, 0x20($sp)
/* 210B0 800204B0 AFB3001C */  sw         $s3, 0x1C($sp)
/* 210B4 800204B4 AFB20018 */  sw         $s2, 0x18($sp)
/* 210B8 800204B8 AFB10014 */  sw         $s1, 0x14($sp)
/* 210BC 800204BC 8C420000 */  lw         $v0, 0x0($v0)
/* 210C0 800204C0 8E040004 */  lw         $a0, 0x4($s0)
/* 210C4 800204C4 8E120008 */  lw         $s2, 0x8($s0)
/* 210C8 800204C8 0C006BB0 */  jal        osVirtualToPhysical
/* 210CC 800204CC 30510001 */   andi      $s1, $v0, 0x1
/* 210D0 800204D0 00111880 */  sll        $v1, $s1, 2
/* 210D4 800204D4 00711821 */  addu       $v1, $v1, $s1
/* 210D8 800204D8 00031880 */  sll        $v1, $v1, 2
/* 210DC 800204DC 02431821 */  addu       $v1, $s2, $v1
/* 210E0 800204E0 8C640028 */  lw         $a0, 0x28($v1)
/* 210E4 800204E4 96030000 */  lhu        $v1, 0x0($s0)
/* 210E8 800204E8 30630002 */  andi       $v1, $v1, 0x2
/* 210EC 800204EC 10600008 */  beqz       $v1, .L80020510
/* 210F0 800204F0 00443021 */   addu      $a2, $v0, $a0
/* 210F4 800204F4 8E420020 */  lw         $v0, 0x20($s2)
/* 210F8 800204F8 8E030020 */  lw         $v1, 0x20($s0)
/* 210FC 800204FC 2404F000 */  addiu      $a0, $zero, -0x1000
/* 21100 80020500 00441024 */  and        $v0, $v0, $a0
/* 21104 80020504 00621825 */  or         $v1, $v1, $v0
/* 21108 80020508 08008146 */  j          .L80020518
/* 2110C 8002050C AE030020 */   sw        $v1, 0x20($s0)
.L80020510:
/* 21110 80020510 8E420020 */  lw         $v0, 0x20($s2)
/* 21114 80020514 AE020020 */  sw         $v0, 0x20($s0)
.L80020518:
/* 21118 80020518 96020000 */  lhu        $v0, 0x0($s0)
/* 2111C 8002051C 30420004 */  andi       $v0, $v0, 0x4
/* 21120 80020520 1040002B */  beqz       $v0, .L800205D0
/* 21124 80020524 00111080 */   sll       $v0, $s1, 2
/* 21128 80020528 00511021 */  addu       $v0, $v0, $s1
/* 2112C 8002052C 00021080 */  sll        $v0, $v0, 2
/* 21130 80020530 02421021 */  addu       $v0, $s2, $v0
/* 21134 80020534 8C42002C */  lw         $v0, 0x2C($v0)
/* 21138 80020538 30420FFF */  andi       $v0, $v0, 0xFFF
/* 2113C 8002053C 44822000 */  mtc1       $v0, $f4
/* 21140 80020540 00000000 */  nop
/* 21144 80020544 04410004 */  bgez       $v0, .L80020558
/* 21148 80020548 46802121 */   cvt.d.w   $f4, $f4
/* 2114C 8002054C 3C018000 */  lui        $at, %hi(D_80001A00)
/* 21150 80020550 D4201A00 */  ldc1       $f0, %lo(D_80001A00)($at)
/* 21154 80020554 46202100 */  add.d      $f4, $f4, $f0
.L80020558:
/* 21158 80020558 C6020024 */  lwc1       $f2, 0x24($s0)
/* 2115C 8002055C 46202020 */  cvt.s.d    $f0, $f4
/* 21160 80020560 46001082 */  mul.s      $f2, $f2, $f0
/* 21164 80020564 3C014F00 */  lui        $at, (0x4F000000 >> 16)
/* 21168 80020568 44810000 */  mtc1       $at, $f0
/* 2116C 8002056C 00000000 */  nop
/* 21170 80020570 4602003E */  c.le.s     $f0, $f2
/* 21174 80020574 00000000 */  nop
/* 21178 80020578 00000000 */  nop
/* 2117C 8002057C 45030006 */  bc1tl      .L80020598
/* 21180 80020580 46001001 */   sub.s     $f0, $f2, $f0
/* 21184 80020584 4600100D */  trunc.w.s  $f0, $f2
/* 21188 80020588 44040000 */  mfc1       $a0, $f0
/* 2118C 8002058C 00000000 */  nop
/* 21190 80020590 0800816B */  j          .L800205AC
/* 21194 80020594 00111080 */   sll       $v0, $s1, 2
.L80020598:
/* 21198 80020598 4600008D */  trunc.w.s  $f2, $f0
/* 2119C 8002059C 44041000 */  mfc1       $a0, $f2
/* 211A0 800205A0 3C028000 */  lui        $v0, (0x80000000 >> 16)
/* 211A4 800205A4 00822025 */  or         $a0, $a0, $v0
/* 211A8 800205A8 00111080 */  sll        $v0, $s1, 2
.L800205AC:
/* 211AC 800205AC 00511021 */  addu       $v0, $v0, $s1
/* 211B0 800205B0 00021080 */  sll        $v0, $v0, 2
/* 211B4 800205B4 02421021 */  addu       $v0, $s2, $v0
/* 211B8 800205B8 AE04002C */  sw         $a0, 0x2C($s0)
/* 211BC 800205BC 8C42002C */  lw         $v0, 0x2C($v0)
/* 211C0 800205C0 2403F000 */  addiu      $v1, $zero, -0x1000
/* 211C4 800205C4 00431024 */  and        $v0, $v0, $v1
/* 211C8 800205C8 08008178 */  j          .L800205E0
/* 211CC 800205CC 00821025 */   or        $v0, $a0, $v0
.L800205D0:
/* 211D0 800205D0 00511021 */  addu       $v0, $v0, $s1
/* 211D4 800205D4 00021080 */  sll        $v0, $v0, 2
/* 211D8 800205D8 02421021 */  addu       $v0, $s2, $v0
/* 211DC 800205DC 8C42002C */  lw         $v0, 0x2C($v0)
.L800205E0:
/* 211E0 800205E0 AE02002C */  sw         $v0, 0x2C($s0)
/* 211E4 800205E4 8E53001C */  lw         $s3, 0x1C($s2)
/* 211E8 800205E8 00111080 */  sll        $v0, $s1, 2
/* 211EC 800205EC 00511021 */  addu       $v0, $v0, $s1
/* 211F0 800205F0 00021080 */  sll        $v0, $v0, 2
/* 211F4 800205F4 02428821 */  addu       $s1, $s2, $v0
/* 211F8 800205F8 96040000 */  lhu        $a0, 0x0($s0)
/* 211FC 800205FC 3C058003 */  lui        $a1, %hi(D_8003115C)
/* 21200 80020600 8CA5115C */  lw         $a1, %lo(D_8003115C)($a1)
/* 21204 80020604 8E230030 */  lw         $v1, 0x30($s1)
/* 21208 80020608 30820020 */  andi       $v0, $a0, 0x20
/* 2120C 8002060C 2C420001 */  sltiu      $v0, $v0, 0x1
/* 21210 80020610 00021023 */  negu       $v0, $v0
/* 21214 80020614 02629824 */  and        $s3, $s3, $v0
/* 21218 80020618 00051400 */  sll        $v0, $a1, 16
/* 2121C 8002061C 00621823 */  subu       $v1, $v1, $v0
/* 21220 80020620 30840040 */  andi       $a0, $a0, 0x40
/* 21224 80020624 10800005 */  beqz       $a0, .L8002063C
/* 21228 80020628 0065A021 */   addu      $s4, $v1, $a1
/* 2122C 8002062C 8E040004 */  lw         $a0, 0x4($s0)
/* 21230 80020630 0C006BB0 */  jal        osVirtualToPhysical
/* 21234 80020634 AE00002C */   sw        $zero, 0x2C($s0)
/* 21238 80020638 00403021 */  addu       $a2, $v0, $zero
.L8002063C:
/* 2123C 8002063C 96020000 */  lhu        $v0, 0x0($s0)
/* 21240 80020640 30420080 */  andi       $v0, $v0, 0x80
/* 21244 80020644 10400008 */  beqz       $v0, .L80020668
/* 21248 80020648 3C0303FF */   lui       $v1, (0x3FF0000 >> 16)
/* 2124C 8002064C 96020028 */  lhu        $v0, 0x28($s0)
/* 21250 80020650 8E040004 */  lw         $a0, 0x4($s0)
/* 21254 80020654 00021400 */  sll        $v0, $v0, 16
/* 21258 80020658 00431024 */  and        $v0, $v0, $v1
/* 2125C 8002065C 0C006BB0 */  jal        osVirtualToPhysical
/* 21260 80020660 AE02002C */   sw        $v0, 0x2C($s0)
/* 21264 80020664 00403021 */  addu       $a2, $v0, $zero
.L80020668:
/* 21268 80020668 3C02A440 */  lui        $v0, (0xA4400004 >> 16)
/* 2126C 8002066C 34420004 */  ori        $v0, $v0, (0xA4400004 & 0xFFFF)
/* 21270 80020670 3C03A440 */  lui        $v1, (0xA4400008 >> 16)
/* 21274 80020674 34630008 */  ori        $v1, $v1, (0xA4400008 & 0xFFFF)
/* 21278 80020678 3C04A440 */  lui        $a0, (0xA4400014 >> 16)
/* 2127C 8002067C 34840014 */  ori        $a0, $a0, (0xA4400014 & 0xFFFF)
/* 21280 80020680 AC460000 */  sw         $a2, 0x0($v0)
/* 21284 80020684 8E420008 */  lw         $v0, 0x8($s2)
/* 21288 80020688 3C05A440 */  lui        $a1, (0xA4400018 >> 16)
/* 2128C 8002068C 34A50018 */  ori        $a1, $a1, (0xA4400018 & 0xFFFF)
/* 21290 80020690 AC620000 */  sw         $v0, 0x0($v1)
/* 21294 80020694 8E42000C */  lw         $v0, 0xC($s2)
/* 21298 80020698 3C06A440 */  lui        $a2, (0xA4400020 >> 16)
/* 2129C 8002069C 34C60020 */  ori        $a2, $a2, (0xA4400020 & 0xFFFF)
/* 212A0 800206A0 AC820000 */  sw         $v0, 0x0($a0)
/* 212A4 800206A4 8E420010 */  lw         $v0, 0x10($s2)
/* 212A8 800206A8 3C03A440 */  lui        $v1, (0xA440001C >> 16)
/* 212AC 800206AC 3463001C */  ori        $v1, $v1, (0xA440001C & 0xFFFF)
/* 212B0 800206B0 ACA20000 */  sw         $v0, 0x0($a1)
/* 212B4 800206B4 8E420014 */  lw         $v0, 0x14($s2)
/* 212B8 800206B8 3C04A440 */  lui        $a0, (0xA4400024 >> 16)
/* 212BC 800206BC 34840024 */  ori        $a0, $a0, (0xA4400024 & 0xFFFF)
/* 212C0 800206C0 AC620000 */  sw         $v0, 0x0($v1)
/* 212C4 800206C4 8E420018 */  lw         $v0, 0x18($s2)
/* 212C8 800206C8 3C03A440 */  lui        $v1, (0xA4400028 >> 16)
/* 212CC 800206CC 34630028 */  ori        $v1, $v1, (0xA4400028 & 0xFFFF)
/* 212D0 800206D0 ACC20000 */  sw         $v0, 0x0($a2)
/* 212D4 800206D4 AC930000 */  sw         $s3, 0x0($a0)
/* 212D8 800206D8 AC740000 */  sw         $s4, 0x0($v1)
/* 212DC 800206DC 8E230034 */  lw         $v1, 0x34($s1)
/* 212E0 800206E0 3C02A440 */  lui        $v0, (0xA440002C >> 16)
/* 212E4 800206E4 3442002C */  ori        $v0, $v0, (0xA440002C & 0xFFFF)
/* 212E8 800206E8 AC430000 */  sw         $v1, 0x0($v0)
/* 212EC 800206EC 8E230038 */  lw         $v1, 0x38($s1)
/* 212F0 800206F0 3C02A440 */  lui        $v0, (0xA440000C >> 16)
/* 212F4 800206F4 3442000C */  ori        $v0, $v0, (0xA440000C & 0xFFFF)
/* 212F8 800206F8 AC430000 */  sw         $v1, 0x0($v0)
/* 212FC 800206FC 8E030020 */  lw         $v1, 0x20($s0)
/* 21300 80020700 3C02A440 */  lui        $v0, (0xA4400030 >> 16)
/* 21304 80020704 34420030 */  ori        $v0, $v0, (0xA4400030 & 0xFFFF)
/* 21308 80020708 AC430000 */  sw         $v1, 0x0($v0)
/* 2130C 8002070C 8E03002C */  lw         $v1, 0x2C($s0)
/* 21310 80020710 3C02A440 */  lui        $v0, (0xA4400034 >> 16)
/* 21314 80020714 34420034 */  ori        $v0, $v0, (0xA4400034 & 0xFFFF)
/* 21318 80020718 AC430000 */  sw         $v1, 0x0($v0)
/* 2131C 8002071C 8E03000C */  lw         $v1, 0xC($s0)
/* 21320 80020720 3C028003 */  lui        $v0, %hi(D_80031130)
/* 21324 80020724 8C421130 */  lw         $v0, %lo(D_80031130)($v0)
/* 21328 80020728 02003021 */  addu       $a2, $s0, $zero
/* 2132C 8002072C 24C80030 */  addiu      $t0, $a2, 0x30
/* 21330 80020730 3C018003 */  lui        $at, %hi(D_80031130)
/* 21334 80020734 AC261130 */  sw         $a2, %lo(D_80031130)($at)
/* 21338 80020738 00403821 */  addu       $a3, $v0, $zero
/* 2133C 8002073C 3C02A440 */  lui        $v0, %hi(D_A4400000)
/* 21340 80020740 3C018003 */  lui        $at, %hi(D_80031134)
/* 21344 80020744 AC271134 */  sw         $a3, %lo(D_80031134)($at)
/* 21348 80020748 AC430000 */  sw         $v1, %lo(D_A4400000)($v0)
.L8002074C:
/* 2134C 8002074C 8CC20000 */  lw         $v0, 0x0($a2)
/* 21350 80020750 8CC30004 */  lw         $v1, 0x4($a2)
/* 21354 80020754 8CC40008 */  lw         $a0, 0x8($a2)
/* 21358 80020758 8CC5000C */  lw         $a1, 0xC($a2)
/* 2135C 8002075C ACE20000 */  sw         $v0, 0x0($a3)
/* 21360 80020760 ACE30004 */  sw         $v1, 0x4($a3)
/* 21364 80020764 ACE40008 */  sw         $a0, 0x8($a3)
/* 21368 80020768 ACE5000C */  sw         $a1, 0xC($a3)
/* 2136C 8002076C 24C60010 */  addiu      $a2, $a2, 0x10
/* 21370 80020770 14C8FFF6 */  bne        $a2, $t0, .L8002074C
/* 21374 80020774 24E70010 */   addiu     $a3, $a3, 0x10
/* 21378 80020778 8FBF0024 */  lw         $ra, 0x24($sp)
/* 2137C 8002077C 8FB40020 */  lw         $s4, 0x20($sp)
/* 21380 80020780 8FB3001C */  lw         $s3, 0x1C($sp)
/* 21384 80020784 8FB20018 */  lw         $s2, 0x18($sp)
/* 21388 80020788 8FB10014 */  lw         $s1, 0x14($sp)
/* 2138C 8002078C 8FB00010 */  lw         $s0, 0x10($sp)
/* 21390 80020790 03E00008 */  jr         $ra
/* 21394 80020794 27BD0028 */   addiu     $sp, $sp, 0x28
/* 21398 80020798 00000000 */  nop
/* 2139C 8002079C 00000000 */  nop
