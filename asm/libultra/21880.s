.include "macro.inc"

# assembler directives
.set noat      # allow manual use of $at
.set noreorder # don't insert nops after branches
.set gp=64     # allow use of 64-bit general purpose registers

.section .text, "ax"

glabel osPfsAllocateFile
/* 21880 80020C80 27BDFD68 */  addiu      $sp, $sp, -0x298
/* 21884 80020C84 AFB00270 */  sw         $s0, 0x270($sp)
/* 21888 80020C88 8FB002AC */  lw         $s0, 0x2AC($sp)
/* 2188C 80020C8C A7A50256 */  sh         $a1, 0x256($sp)
/* 21890 80020C90 97A50256 */  lhu        $a1, 0x256($sp)
/* 21894 80020C94 AFB20278 */  sw         $s2, 0x278($sp)
/* 21898 80020C98 00809021 */  addu       $s2, $a0, $zero
/* 2189C 80020C9C AFB60288 */  sw         $s6, 0x288($sp)
/* 218A0 80020CA0 0000B021 */  addu       $s6, $zero, $zero
/* 218A4 80020CA4 AFB7028C */  sw         $s7, 0x28C($sp)
/* 218A8 80020CA8 0000B821 */  addu       $s7, $zero, $zero
/* 218AC 80020CAC AFB50284 */  sw         $s5, 0x284($sp)
/* 218B0 80020CB0 0000A821 */  addu       $s5, $zero, $zero
/* 218B4 80020CB4 AFA6025C */  sw         $a2, 0x25C($sp)
/* 218B8 80020CB8 2CC30001 */  sltiu      $v1, $a2, 0x1
/* 218BC 80020CBC AFBF0294 */  sw         $ra, 0x294($sp)
/* 218C0 80020CC0 AFBE0290 */  sw         $fp, 0x290($sp)
/* 218C4 80020CC4 AFB40280 */  sw         $s4, 0x280($sp)
/* 218C8 80020CC8 AFB3027C */  sw         $s3, 0x27C($sp)
/* 218CC 80020CCC AFB10274 */  sw         $s1, 0x274($sp)
/* 218D0 80020CD0 2CA20001 */  sltiu      $v0, $a1, 0x1
/* 218D4 80020CD4 00431025 */  or         $v0, $v0, $v1
/* 218D8 80020CD8 14400020 */  bnez       $v0, .L80020D5C
/* 218DC 80020CDC AFA70264 */   sw        $a3, 0x264($sp)
/* 218E0 80020CE0 260600FF */  addiu      $a2, $s0, 0xFF
/* 218E4 80020CE4 04C20001 */  bltzl      $a2, .L80020CEC
/* 218E8 80020CE8 260601FE */   addiu     $a2, $s0, 0x1FE
.L80020CEC:
/* 218EC 80020CEC 00069A03 */  sra        $s3, $a2, 8
/* 218F0 80020CF0 8FA802A8 */  lw         $t0, 0x2A8($sp)
/* 218F4 80020CF4 8FA6025C */  lw         $a2, 0x25C($sp)
/* 218F8 80020CF8 8FA70264 */  lw         $a3, 0x264($sp)
/* 218FC 80020CFC AFA80010 */  sw         $t0, 0x10($sp)
/* 21900 80020D00 8FA802B0 */  lw         $t0, 0x2B0($sp)
/* 21904 80020D04 02402021 */  addu       $a0, $s2, $zero
/* 21908 80020D08 0C00862C */  jal        osPfsFindFile
/* 2190C 80020D0C AFA80014 */   sw        $t0, 0x14($sp)
/* 21910 80020D10 00401821 */  addu       $v1, $v0, $zero
/* 21914 80020D14 10600003 */  beqz       $v1, .L80020D24
/* 21918 80020D18 24020005 */   addiu     $v0, $zero, 0x5
/* 2191C 80020D1C 1462008F */  bne        $v1, $v0, .L80020F5C
/* 21920 80020D20 00601021 */   addu      $v0, $v1, $zero
.L80020D24:
/* 21924 80020D24 8FA802B0 */  lw         $t0, 0x2B0($sp)
/* 21928 80020D28 8D030000 */  lw         $v1, 0x0($t0)
/* 2192C 80020D2C 2402FFFF */  addiu      $v0, $zero, -0x1
/* 21930 80020D30 1462008A */  bne        $v1, $v0, .L80020F5C
/* 21934 80020D34 24020009 */   addiu     $v0, $zero, 0x9
/* 21938 80020D38 02402021 */  addu       $a0, $s2, $zero
/* 2193C 80020D3C 0C008754 */  jal        osPfsFreeBlocks
/* 21940 80020D40 27A50240 */   addiu     $a1, $sp, 0x240
/* 21944 80020D44 8FA20240 */  lw         $v0, 0x240($sp)
/* 21948 80020D48 0050102A */  slt        $v0, $v0, $s0
/* 2194C 80020D4C 14400083 */  bnez       $v0, .L80020F5C
/* 21950 80020D50 24020007 */   addiu     $v0, $zero, 0x7
/* 21954 80020D54 16600003 */  bnez       $s3, .L80020D64
/* 21958 80020D58 02402021 */   addu      $a0, $s2, $zero
.L80020D5C:
/* 2195C 80020D5C 080083D7 */  j          .L80020F5C
/* 21960 80020D60 24020005 */   addiu     $v0, $zero, 0x5
.L80020D64:
/* 21964 80020D64 00002821 */  addu       $a1, $zero, $zero
/* 21968 80020D68 8FA802B0 */  lw         $t0, 0x2B0($sp)
/* 2196C 80020D6C 00003021 */  addu       $a2, $zero, $zero
/* 21970 80020D70 00003821 */  addu       $a3, $zero, $zero
/* 21974 80020D74 AFA00010 */  sw         $zero, 0x10($sp)
/* 21978 80020D78 0C00862C */  jal        osPfsFindFile
/* 2197C 80020D7C AFA80014 */   sw        $t0, 0x14($sp)
/* 21980 80020D80 00401821 */  addu       $v1, $v0, $zero
/* 21984 80020D84 10600003 */  beqz       $v1, .L80020D94
/* 21988 80020D88 24020005 */   addiu     $v0, $zero, 0x5
/* 2198C 80020D8C 14620073 */  bne        $v1, $v0, .L80020F5C
/* 21990 80020D90 00601021 */   addu      $v0, $v1, $zero
.L80020D94:
/* 21994 80020D94 8FA802B0 */  lw         $t0, 0x2B0($sp)
/* 21998 80020D98 8D030000 */  lw         $v1, 0x0($t0)
/* 2199C 80020D9C 2402FFFF */  addiu      $v0, $zero, -0x1
/* 219A0 80020DA0 1062006E */  beq        $v1, $v0, .L80020F5C
/* 219A4 80020DA4 24020008 */   addiu     $v0, $zero, 0x8
/* 219A8 80020DA8 92420064 */  lbu        $v0, 0x64($s2)
/* 219AC 80020DAC 1040004A */  beqz       $v0, .L80020ED8
/* 219B0 80020DB0 00008821 */   addu      $s1, $zero, $zero
/* 219B4 80020DB4 27B40120 */  addiu      $s4, $sp, 0x120
/* 219B8 80020DB8 02402021 */  addu       $a0, $s2, $zero
.L80020DBC:
/* 219BC 80020DBC 27A50020 */  addiu      $a1, $sp, 0x20
/* 219C0 80020DC0 00003021 */  addu       $a2, $zero, $zero
/* 219C4 80020DC4 323000FF */  andi       $s0, $s1, 0xFF
/* 219C8 80020DC8 0C008D23 */  jal        func_8002348C
/* 219CC 80020DCC 02003821 */   addu      $a3, $s0, $zero
/* 219D0 80020DD0 00401821 */  addu       $v1, $v0, $zero
/* 219D4 80020DD4 14600048 */  bnez       $v1, .L80020EF8
/* 219D8 80020DD8 02402021 */   addu      $a0, $s2, $zero
/* 219DC 80020DDC 27A50020 */  addiu      $a1, $sp, 0x20
/* 219E0 80020DE0 02603021 */  addu       $a2, $s3, $zero
/* 219E4 80020DE4 27A70244 */  addiu      $a3, $sp, 0x244
/* 219E8 80020DE8 27A20248 */  addiu      $v0, $sp, 0x248
/* 219EC 80020DEC AFA20014 */  sw         $v0, 0x14($sp)
/* 219F0 80020DF0 27A2024C */  addiu      $v0, $sp, 0x24C
/* 219F4 80020DF4 AFB00010 */  sw         $s0, 0x10($sp)
/* 219F8 80020DF8 0C0083E3 */  jal        func_80020F8C
/* 219FC 80020DFC AFA20018 */   sw        $v0, 0x18($sp)
/* 21A00 80020E00 00401821 */  addu       $v1, $v0, $zero
/* 21A04 80020E04 1460003C */  bnez       $v1, .L80020EF8
/* 21A08 80020E08 2402FFFF */   addiu     $v0, $zero, -0x1
/* 21A0C 80020E0C 8FA30244 */  lw         $v1, 0x244($sp)
/* 21A10 80020E10 1062002B */  beq        $v1, $v0, .L80020EC0
/* 21A14 80020E14 00000000 */   nop
/* 21A18 80020E18 12A0000F */  beqz       $s5, .L80020E58
/* 21A1C 80020E1C 02402021 */   addu      $a0, $s2, $zero
/* 21A20 80020E20 02802821 */  addu       $a1, $s4, $zero
/* 21A24 80020E24 00161040 */  sll        $v0, $s6, 1
/* 21A28 80020E28 02821021 */  addu       $v0, $s4, $v0
/* 21A2C 80020E2C A0510000 */  sb         $s1, 0x0($v0)
/* 21A30 80020E30 8FA30244 */  lw         $v1, 0x244($sp)
/* 21A34 80020E34 24060001 */  addiu      $a2, $zero, 0x1
/* 21A38 80020E38 32E700FF */  andi       $a3, $s7, 0xFF
/* 21A3C 80020E3C 0C008D23 */  jal        func_8002348C
/* 21A40 80020E40 A0430001 */   sb        $v1, 0x1($v0)
/* 21A44 80020E44 00401821 */  addu       $v1, $v0, $zero
/* 21A48 80020E48 10600006 */  beqz       $v1, .L80020E64
/* 21A4C 80020E4C 00000000 */   nop
/* 21A50 80020E50 080083D7 */  j          .L80020F5C
/* 21A54 80020E54 00000000 */   nop
.L80020E58:
/* 21A58 80020E58 306300FF */  andi       $v1, $v1, 0xFF
/* 21A5C 80020E5C 00111200 */  sll        $v0, $s1, 8
/* 21A60 80020E60 0043F025 */  or         $fp, $v0, $v1
.L80020E64:
/* 21A64 80020E64 8FA20248 */  lw         $v0, 0x248($sp)
/* 21A68 80020E68 0053102A */  slt        $v0, $v0, $s3
/* 21A6C 80020E6C 1440000C */  bnez       $v0, .L80020EA0
/* 21A70 80020E70 27A40020 */   addiu     $a0, $sp, 0x20
/* 21A74 80020E74 00009821 */  addu       $s3, $zero, $zero
/* 21A78 80020E78 02402021 */  addu       $a0, $s2, $zero
/* 21A7C 80020E7C 27A50020 */  addiu      $a1, $sp, 0x20
/* 21A80 80020E80 24060001 */  addiu      $a2, $zero, 0x1
/* 21A84 80020E84 0C008D23 */  jal        func_8002348C
/* 21A88 80020E88 322700FF */   andi      $a3, $s1, 0xFF
/* 21A8C 80020E8C 00401821 */  addu       $v1, $v0, $zero
/* 21A90 80020E90 10600011 */  beqz       $v1, .L80020ED8
/* 21A94 80020E94 00000000 */   nop
/* 21A98 80020E98 080083D7 */  j          .L80020F5C
/* 21A9C 80020E9C 00000000 */   nop
.L80020EA0:
/* 21AA0 80020EA0 27A50120 */  addiu      $a1, $sp, 0x120
/* 21AA4 80020EA4 0C007874 */  jal        func_8001E1D0
/* 21AA8 80020EA8 24060100 */   addiu     $a2, $zero, 0x100
/* 21AAC 80020EAC 8FB6024C */  lw         $s6, 0x24C($sp)
/* 21AB0 80020EB0 8FA20248 */  lw         $v0, 0x248($sp)
/* 21AB4 80020EB4 0220B821 */  addu       $s7, $s1, $zero
/* 21AB8 80020EB8 26B50001 */  addiu      $s5, $s5, 0x1
/* 21ABC 80020EBC 02629823 */  subu       $s3, $s3, $v0
.L80020EC0:
/* 21AC0 80020EC0 92430064 */  lbu        $v1, 0x64($s2)
/* 21AC4 80020EC4 26310001 */  addiu      $s1, $s1, 0x1
/* 21AC8 80020EC8 322200FF */  andi       $v0, $s1, 0xFF
/* 21ACC 80020ECC 0043102B */  sltu       $v0, $v0, $v1
/* 21AD0 80020ED0 1440FFBA */  bnez       $v0, .L80020DBC
/* 21AD4 80020ED4 02402021 */   addu      $a0, $s2, $zero
.L80020ED8:
/* 21AD8 80020ED8 1E600020 */  bgtz       $s3, .L80020F5C
/* 21ADC 80020EDC 24020003 */   addiu     $v0, $zero, 0x3
/* 21AE0 80020EE0 8FA30244 */  lw         $v1, 0x244($sp)
/* 21AE4 80020EE4 2402FFFF */  addiu      $v0, $zero, -0x1
/* 21AE8 80020EE8 14620005 */  bne        $v1, $v0, .L80020F00
/* 21AEC 80020EEC 27A50230 */   addiu     $a1, $sp, 0x230
/* 21AF0 80020EF0 080083D7 */  j          .L80020F5C
/* 21AF4 80020EF4 24020003 */   addiu     $v0, $zero, 0x3
.L80020EF8:
/* 21AF8 80020EF8 080083D7 */  j          .L80020F5C
/* 21AFC 80020EFC 00601021 */   addu      $v0, $v1, $zero
.L80020F00:
/* 21B00 80020F00 97A80256 */  lhu        $t0, 0x256($sp)
/* 21B04 80020F04 8FA40264 */  lw         $a0, 0x264($sp)
/* 21B08 80020F08 A7A80224 */  sh         $t0, 0x224($sp)
/* 21B0C 80020F0C 8FA8025C */  lw         $t0, 0x25C($sp)
/* 21B10 80020F10 24060010 */  addiu      $a2, $zero, 0x10
/* 21B14 80020F14 A7BE0226 */  sh         $fp, 0x226($sp)
/* 21B18 80020F18 A7A0022A */  sh         $zero, 0x22A($sp)
/* 21B1C 80020F1C 0C007874 */  jal        func_8001E1D0
/* 21B20 80020F20 AFA80220 */   sw        $t0, 0x220($sp)
/* 21B24 80020F24 8FA402A8 */  lw         $a0, 0x2A8($sp)
/* 21B28 80020F28 27A5022C */  addiu      $a1, $sp, 0x22C
/* 21B2C 80020F2C 0C007874 */  jal        func_8001E1D0
/* 21B30 80020F30 24060004 */   addiu     $a2, $zero, 0x4
/* 21B34 80020F34 8FA802B0 */  lw         $t0, 0x2B0($sp)
/* 21B38 80020F38 8E46005C */  lw         $a2, 0x5C($s2)
/* 21B3C 80020F3C 8D020000 */  lw         $v0, 0x0($t0)
/* 21B40 80020F40 27A70220 */  addiu      $a3, $sp, 0x220
/* 21B44 80020F44 AFA00010 */  sw         $zero, 0x10($sp)
/* 21B48 80020F48 8E440004 */  lw         $a0, 0x4($s2)
/* 21B4C 80020F4C 8E450008 */  lw         $a1, 0x8($s2)
/* 21B50 80020F50 00C23021 */  addu       $a2, $a2, $v0
/* 21B54 80020F54 0C008E70 */  jal        func_800239C0
/* 21B58 80020F58 30C6FFFF */   andi      $a2, $a2, 0xFFFF
.L80020F5C:
/* 21B5C 80020F5C 8FBF0294 */  lw         $ra, 0x294($sp)
/* 21B60 80020F60 8FBE0290 */  lw         $fp, 0x290($sp)
/* 21B64 80020F64 8FB7028C */  lw         $s7, 0x28C($sp)
/* 21B68 80020F68 8FB60288 */  lw         $s6, 0x288($sp)
/* 21B6C 80020F6C 8FB50284 */  lw         $s5, 0x284($sp)
/* 21B70 80020F70 8FB40280 */  lw         $s4, 0x280($sp)
/* 21B74 80020F74 8FB3027C */  lw         $s3, 0x27C($sp)
/* 21B78 80020F78 8FB20278 */  lw         $s2, 0x278($sp)
/* 21B7C 80020F7C 8FB10274 */  lw         $s1, 0x274($sp)
/* 21B80 80020F80 8FB00270 */  lw         $s0, 0x270($sp)
/* 21B84 80020F84 03E00008 */  jr         $ra
/* 21B88 80020F88 27BD0298 */   addiu     $sp, $sp, 0x298

glabel func_80020F8C
/* 21B8C 80020F8C 24020001 */  addiu      $v0, $zero, 0x1
/* 21B90 80020F90 8FAA0014 */  lw         $t2, 0x14($sp)
/* 21B94 80020F94 93AB0013 */  lbu        $t3, 0x13($sp)
/* 21B98 80020F98 8FAE0018 */  lw         $t6, 0x18($sp)
/* 21B9C 80020F9C 15600002 */  bnez       $t3, .L80020FA8
/* 21BA0 80020FA0 00007821 */   addu      $t7, $zero, $zero
/* 21BA4 80020FA4 8C820060 */  lw         $v0, 0x60($a0)
.L80020FA8:
/* 21BA8 80020FA8 00402021 */  addu       $a0, $v0, $zero
/* 21BAC 80020FAC 28820080 */  slti       $v0, $a0, 0x80
/* 21BB0 80020FB0 1040000A */  beqz       $v0, .L80020FDC
/* 21BB4 80020FB4 00041040 */   sll       $v0, $a0, 1
/* 21BB8 80020FB8 24080003 */  addiu      $t0, $zero, 0x3
/* 21BBC 80020FBC 00451821 */  addu       $v1, $v0, $a1
.L80020FC0:
/* 21BC0 80020FC0 94620000 */  lhu        $v0, 0x0($v1)
/* 21BC4 80020FC4 10480006 */  beq        $v0, $t0, .L80020FE0
/* 21BC8 80020FC8 24020080 */   addiu     $v0, $zero, 0x80
/* 21BCC 80020FCC 24840001 */  addiu      $a0, $a0, 0x1
/* 21BD0 80020FD0 28820080 */  slti       $v0, $a0, 0x80
/* 21BD4 80020FD4 1440FFFA */  bnez       $v0, .L80020FC0
/* 21BD8 80020FD8 24630002 */   addiu     $v1, $v1, 0x2
.L80020FDC:
/* 21BDC 80020FDC 24020080 */  addiu      $v0, $zero, 0x80
.L80020FE0:
/* 21BE0 80020FE0 14820004 */  bne        $a0, $v0, .L80020FF4
/* 21BE4 80020FE4 24030001 */   addiu     $v1, $zero, 0x1
/* 21BE8 80020FE8 2402FFFF */  addiu      $v0, $zero, -0x1
/* 21BEC 80020FEC 08008427 */  j          .L8002109C
/* 21BF0 80020FF0 ACE20000 */   sw        $v0, 0x0($a3)
.L80020FF4:
/* 21BF4 80020FF4 AD430000 */  sw         $v1, 0x0($t2)
/* 21BF8 80020FF8 00804021 */  addu       $t0, $a0, $zero
/* 21BFC 80020FFC 25040001 */  addiu      $a0, $t0, 0x1
/* 21C00 80021000 0066182A */  slt        $v1, $v1, $a2
/* 21C04 80021004 28820080 */  slti       $v0, $a0, 0x80
/* 21C08 80021008 00621824 */  and        $v1, $v1, $v0
/* 21C0C 8002100C 10600015 */  beqz       $v1, .L80021064
/* 21C10 80021010 01006821 */   addu      $t5, $t0, $zero
/* 21C14 80021014 240C0003 */  addiu      $t4, $zero, 0x3
/* 21C18 80021018 00041040 */  sll        $v0, $a0, 1
/* 21C1C 8002101C 00454821 */  addu       $t1, $v0, $a1
.L80021020:
/* 21C20 80021020 95220000 */  lhu        $v0, 0x0($t1)
/* 21C24 80021024 144C0008 */  bne        $v0, $t4, .L80021048
/* 21C28 80021028 00081040 */   sll       $v0, $t0, 1
/* 21C2C 8002102C 00A21021 */  addu       $v0, $a1, $v0
/* 21C30 80021030 A04B0000 */  sb         $t3, 0x0($v0)
/* 21C34 80021034 A0440001 */  sb         $a0, 0x1($v0)
/* 21C38 80021038 8D420000 */  lw         $v0, 0x0($t2)
/* 21C3C 8002103C 00804021 */  addu       $t0, $a0, $zero
/* 21C40 80021040 24420001 */  addiu      $v0, $v0, 0x1
/* 21C44 80021044 AD420000 */  sw         $v0, 0x0($t2)
.L80021048:
/* 21C48 80021048 8D430000 */  lw         $v1, 0x0($t2)
/* 21C4C 8002104C 24840001 */  addiu      $a0, $a0, 0x1
/* 21C50 80021050 28820080 */  slti       $v0, $a0, 0x80
/* 21C54 80021054 0066182A */  slt        $v1, $v1, $a2
/* 21C58 80021058 00621824 */  and        $v1, $v1, $v0
/* 21C5C 8002105C 1460FFF0 */  bnez       $v1, .L80021020
/* 21C60 80021060 25290002 */   addiu     $t1, $t1, 0x2
.L80021064:
/* 21C64 80021064 24020080 */  addiu      $v0, $zero, 0x80
/* 21C68 80021068 14820007 */  bne        $a0, $v0, .L80021088
/* 21C6C 8002106C ACED0000 */   sw        $t5, 0x0($a3)
/* 21C70 80021070 8D420000 */  lw         $v0, 0x0($t2)
/* 21C74 80021074 0046102A */  slt        $v0, $v0, $a2
/* 21C78 80021078 50400004 */  beql       $v0, $zero, .L8002108C
/* 21C7C 8002107C 00081040 */   sll       $v0, $t0, 1
/* 21C80 80021080 08008427 */  j          .L8002109C
/* 21C84 80021084 ADC80000 */   sw        $t0, 0x0($t6)
.L80021088:
/* 21C88 80021088 00081040 */  sll        $v0, $t0, 1
.L8002108C:
/* 21C8C 8002108C 00A21021 */  addu       $v0, $a1, $v0
/* 21C90 80021090 24030001 */  addiu      $v1, $zero, 0x1
/* 21C94 80021094 A4430000 */  sh         $v1, 0x0($v0)
/* 21C98 80021098 ADC00000 */  sw         $zero, 0x0($t6)
.L8002109C:
/* 21C9C 8002109C 03E00008 */  jr         $ra
/* 21CA0 800210A0 01E01021 */   addu      $v0, $t7, $zero
/* 21CA4 800210A4 00000000 */  nop
/* 21CA8 800210A8 00000000 */  nop
/* 21CAC 800210AC 00000000 */  nop
